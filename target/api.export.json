[{"line":2,"elements":[{"line":4,"name":"","description":"","type":"background","keyword":"Background","steps":[{"name":"configure logPrettyResponse = false","result":{"duration":1070300,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# 1. LLAMANDO AL SERVICIO AUTHTOKEN PARA HACER LOGIN Y OBTENER EL TOKEN"],"keyword":"*","line":6},{"name":"configure logPrettyRequest = false","result":{"duration":289900,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":7},{"name":"def validBodyRequest = read('classpath:JsonRequest\/loginTokenRequest.json')","result":{"duration":36022700,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":8},{"name":"def loginResponse = call read('classpath:api\/loginToken.feature') { request: validBodyRequest }","result":{"duration":2300562300,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":9},{"name":"api\/loginToken.feature","result":{"duration":0,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"","line":9},{"name":"url loginUrl","result":{"duration":1246200,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":4},{"name":"print loginUrl","result":{"duration":3986600,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":5,"doc_string":{"content_type":"","value":"09:36:59.588 [print] http:\/\/ms-auth-oss-git-dev-front-oss.apps.tmve-nprod-1.tmve-qa.com\/intraLogin \n","line":5}},{"name":"def schemaUtil = Java.type('util.JsonSchemaUtil')","result":{"duration":4505500,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":6},{"name":"def schemaText = karate.readAsString('classpath:Schema\/sc_loginToken.json')","result":{"duration":1247100,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":7},{"name":"def validBodyRequest = read('classpath:JsonRequest\/loginTokenRequest.json')","result":{"duration":742200,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":8},{"name":"request validBodyRequest","result":{"duration":319700,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Given","line":12},{"name":"method POST","result":{"duration":1975511000,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> When","line":13,"doc_string":{"content_type":"","value":"09:36:59.857 request:\n1 > POST http:\/\/ms-auth-oss-git-dev-front-oss.apps.tmve-nprod-1.tmve-qa.com\/intraLogin\n1 > Content-Type: application\/json; charset=UTF-8\n1 > Content-Length: 39\n1 > Host: ms-auth-oss-git-dev-front-oss.apps.tmve-nprod-1.tmve-qa.com\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n{\"login\":\"tns01\",\"clave\":\"T3st2024.+-\"}\n\n09:37:01.571 response time in milliseconds: 1707\n1 < 200\n1 < content-type: application\/json\n1 < content-length: 326\n1 < set-cookie: 346a326bcc8fc21fd3f034fd94d160bb=b93258c5db05ebda8c79fad18868405b; path=\/; HttpOnly\n1 < Set-Cookie: 346a326bcc8fc21fd3f034fd94d160bb=b93258c5db05ebda8c79fad18868405b; path=\/; HttpOnly\n{\"token\":\"eyJhbGciOiJIUzM4NCJ9.eyJjb2RFbXBsb3llZSI6IjhDM0ZFRTcwMUU3RUI0QkVBNTREOTZBNjhFNTE1RTMwIiwic3ViIjoiZGVmYXVsdC1zdWJqZWN0IiwiaXNzIjoiZGVmYXVsdC1pc3N1ZXIiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJkZWZhdWx0LXVzZXJuYW1lIiwiaWF0IjoxNzU2NDc0NjIxLCJleHAiOjE3NTY0NzgyMjF9.suUYUCNOwbkdWDC45p1xF6zdWJc1Mx_TMBjDtaKgjLrR09iJ4I8H-szcK1shkiCm\"}\n\n","line":13}},{"name":"status 200","result":{"duration":16100,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Then","line":14},{"name":"match response.token == '#string'","result":{"duration":10423300,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# Validar que la respuesta contenga el campo token"],"keyword":"> And","line":17},{"name":"def responseText = karate.pretty(response)","result":{"duration":17639800,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# Validar la estructura completa de la respuesta usando el schema JSON"],"keyword":"> *","line":20},{"name":"def isValid = schemaUtil.isValid(schemaText, responseText)","result":{"duration":262675500,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":21},{"name":"match isValid == true","result":{"duration":628500,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":22},{"result":{"duration":8286200,"status":"passed"},"comments":["# Tiempo de respuesta"],"line":25,"name":"print '=== TIEMPO DE RESPUESTA DEL FEATURE loginToken ===', responseTime \/ 1000, 's'","match":{"location":"karate","arguments":[]},"keyword":"> And","doc_string":{"content_type":"","value":"09:37:01.873 [print] === TIEMPO DE RESPUESTA DEL FEATURE loginToken === 1.707 s \n","line":25}},{"name":"def authToken = loginResponse.response.token","result":{"duration":1089300,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":10},{"name":"def headers = headersEstacionesConToken(authToken)","result":{"duration":5332300,"status":"passed"},"match":{"location":"karate","arguments":[]},"comments":["# 2. CONFIGURANDO HEADERS PARA ESTACIONES"],"keyword":"*","line":13},{"name":"configure headers = headers","result":{"duration":151200,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":14},{"name":"print 'TOKEN obtenido:', authToken","result":{"duration":1137300,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":15,"doc_string":{"content_type":"","value":"09:37:01.881 [print] TOKEN obtenido: eyJhbGciOiJIUzM4NCJ9.eyJjb2RFbXBsb3llZSI6IjhDM0ZFRTcwMUU3RUI0QkVBNTREOTZBNjhFNTE1RTMwIiwic3ViIjoiZGVmYXVsdC1zdWJqZWN0IiwiaXNzIjoiZGVmYXVsdC1pc3N1ZXIiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJkZWZhdWx0LXVzZXJuYW1lIiwiaWF0IjoxNzU2NDc0NjIxLCJleHAiOjE3NTY0NzgyMjF9.suUYUCNOwbkdWDC45p1xF6zdWJc1Mx_TMBjDtaKgjLrR09iJ4I8H-szcK1shkiCm \n","line":15}}]},{"start_timestamp":"2025-08-29T13:36:59.478Z","line":18,"name":"El endpoint debe permitir descargar el archivo Excel con las estaciones registradas","description":"","id":"el-endpoint-debe-permitir-descargar-el-archivo-excel-con-las-estaciones-registradas","type":"scenario","keyword":"Scenario","steps":[{"name":"url baseUrl + '\/export'","result":{"duration":4659600,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Given","line":19},{"name":"headers headers","result":{"duration":692300,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":20},{"result":{"duration":701672100,"status":"passed"},"comments":["##And param page = 1"],"line":22,"name":"method POST","match":{"location":"karate","arguments":[]},"keyword":"When","doc_string":{"content_type":"","value":"09:37:01.890 request:\n1 > POST http:\/\/estaciones-bff-git-dev-front-oss.apps.tmve-nprod-1.tmve-qa.com\/api\/v1\/estaciones\/\/export\n1 > Content-Type: application\/json\n1 > X-USER-ID: E11011\n1 > X-CORRELATION-ID: 1445|E11011|234234\n1 > X-TOKEN-ID: eyJhbGciOiJIUzM4NCJ9.eyJjb2RFbXBsb3llZSI6IjhDM0ZFRTcwMUU3RUI0QkVBNTREOTZBNjhFNTE1RTMwIiwic3ViIjoiZGVmYXVsdC1zdWJqZWN0IiwiaXNzIjoiZGVmYXVsdC1pc3N1ZXIiLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJkZWZhdWx0LXVzZXJuYW1lIiwiaWF0IjoxNzU2NDc0NjIxLCJleHAiOjE3NTY0NzgyMjF9.suUYUCNOwbkdWDC45p1xF6zdWJc1Mx_TMBjDtaKgjLrR09iJ4I8H-szcK1shkiCm\n1 > Host: estaciones-bff-git-dev-front-oss.apps.tmve-nprod-1.tmve-qa.com\n1 > Connection: Keep-Alive\n1 > User-Agent: Apache-HttpClient\/4.5.14 (Java\/17.0.12)\n1 > Accept-Encoding: gzip,deflate\n\n\n09:37:02.588 response time in milliseconds: 698\n1 < 400\n1 < content-length: 395\n1 < content-type: application\/json\n1 < set-cookie: 7ebc866ebb4d2d727ca53353a6c0c030=739fd5a9a7733606de7260d59fb218e7; path=\/; HttpOnly\n1 < Set-Cookie: 7ebc866ebb4d2d727ca53353a6c0c030=739fd5a9a7733606de7260d59fb218e7; path=\/; HttpOnly\n{\"success\":false,\"data\":{\"code\":\"400\",\"status\":\"BAD_REQUEST\",\"message\":\"Error injecting ve.com.telefonica.infrastructure.MDireccionesService ve.com.telefonica.domain.service.DefaultStationService.serviceDireccion\",\"errors\":[\"Error injecting ve.com.telefonica.infrastructure.MDireccionesService ve.com.telefonica.domain.service.DefaultStationService.serviceDireccion\"]},\"timestamp\":1756474622351}\n\n","line":22}},{"name":"status 200","result":{"duration":9804200,"error_message":"status code was: 400, expected: 200, response time in milliseconds: 698, url: http:\/\/estaciones-bff-git-dev-front-oss.apps.tmve-nprod-1.tmve-qa.com\/api\/v1\/estaciones\/\/export, response: \n{\"success\":false,\"data\":{\"code\":\"400\",\"status\":\"BAD_REQUEST\",\"message\":\"Error injecting ve.com.telefonica.infrastructure.MDireccionesService ve.com.telefonica.domain.service.DefaultStationService.serviceDireccion\",\"errors\":[\"Error injecting ve.com.telefonica.infrastructure.MDireccionesService ve.com.telefonica.domain.service.DefaultStationService.serviceDireccion\"]},\"timestamp\":1756474622351}\nclasspath:api\/export.feature:23","status":"failed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":23,"doc_string":{"content_type":"","value":"09:37:02.599 classpath:api\/export.feature:23\nThen status 200\nstatus code was: 400, expected: 200, response time in milliseconds: 698, url: http:\/\/estaciones-bff-git-dev-front-oss.apps.tmve-nprod-1.tmve-qa.com\/api\/v1\/estaciones\/\/export, response: \n{\"success\":false,\"data\":{\"code\":\"400\",\"status\":\"BAD_REQUEST\",\"message\":\"Error injecting ve.com.telefonica.infrastructure.MDireccionesService ve.com.telefonica.domain.service.DefaultStationService.serviceDireccion\",\"errors\":[\"Error injecting ve.com.telefonica.infrastructure.MDireccionesService ve.com.telefonica.domain.service.DefaultStationService.serviceDireccion\"]},\"timestamp\":1756474622351}\nclasspath:api\/export.feature:23\n","line":23}},{"name":"match header Content-Type contains 'application\/vnd.openxmlformats-officedocument.spreadsheetml.sheet'","result":{"duration":0,"status":"skipped"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":24},{"name":"def fileName = responseHeaders['content-disposition'] ? responseHeaders['content-disposition'].split('filename=')[1] : 'estaciones_export.xlsx'","result":{"duration":0,"status":"skipped"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":26},{"name":"def fileSize = responseHeaders['content-length'] || 'desconocido'","result":{"duration":0,"status":"skipped"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":27},{"name":"print 'Nombre del archivo:', fileName","result":{"duration":0,"status":"skipped"},"match":{"location":"karate","arguments":[]},"comments":["# === ARCHIVO EXCEL GENERADO ==="],"keyword":"And","line":30},{"name":"print 'Tamaño del archivo:', fileSize, 'bytes'","result":{"duration":0,"status":"skipped"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":31},{"name":"print '=== TIEMPO DE RESPUESTA DEL FEATURE ===', responseTime \/ 1000, 's'","result":{"duration":0,"status":"skipped"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":32}],"tags":[{"name":"@descargarExcelEstaciones","line":17},{"name":"@exportEstaciones","line":1}]}],"name":"api\/export.feature","description":"Exportar estaciones mediante el endpoint GET \/estaciones\/export","id":"exportar-estaciones-mediante-el-endpoint-get--estaciones-export","keyword":"Feature","uri":"api\/export.feature","tags":[{"name":"@exportEstaciones","line":1}]}]